<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>CMapper - roodan visual map</title>
  <style>
    html, body { height: 100%; margin: 0; font-family: Arial, sans-serif; background: #0c1b2a; color: #e8edf2; }
    #topbar { padding: 12px 16px; border-bottom: 1px solid #1e3147; background: #13263b; }
    #network { height: calc(100% - 54px); background: radial-gradient(circle at 20% 20%, #123, #0b1826); }
    .muted { color: #9fb3c8; font-size: 13px; }
    .node-label { fill: #e8edf2; font-size: 12px; pointer-events: none; }
    .node-circle { fill: #1f8ef1; stroke: #c1ddff; stroke-width: 1; }
    .edge { stroke: #5c7ea8; stroke-width: 1.3; opacity: 0.7; }
    .edge-label { fill: #c7d7e6; font-size: 11px; }
    .tooltip {
      position: absolute;
      background: rgba(10, 20, 35, 0.9);
      color: #e8edf2;
      padding: 6px 10px;
      border: 1px solid #234;
      border-radius: 6px;
      pointer-events: none;
      font-size: 12px;
      display: none;
    }
  </style>
</head>
<body>
  <div id="topbar">
    <div><b>Site:</b> roodan <span class="muted">(9 devices, 8 links)</span></div>
    <div class="muted">Generated 2025-12-27T16:19:48</div>
  </div>
  <div id="network">
    <svg id="svg" width="100%" height="100%"></svg>
    <div id="tooltip" class="tooltip"></div>
  </div>
  <script>
    const nodes = [{"id": "dev_878920a8", "label": "Device-10.192.178.2", "title": "10.192.178.2 | unknown | cisco WS-C2960S-48FPS-L"}, {"id": "dev_49f0dab0", "label": "RW-Bandar.OKCO.ir", "title": "10.192.178.1 | unknown | Cisco CISCO2911/K9"}, {"id": "dev_762b3bad", "label": "Sw4-Dry-BalayeEdari.OKCO.ir", "title": "10.192.178.4 | unknown | cisco WS-C2960S-48FPS-L"}, {"id": "dev_552a5da9", "label": "BAbbad-DHCP", "title": "10.192.178.253 | unknown | MikroTik"}, {"id": "dev_0608a1e0", "label": "sw3-Dry-Buffer.OKCO.ir", "title": "10.192.178.3 | unknown | cisco WS-C2960S-48FPS-L"}, {"id": "dev_1b421904", "label": "SXT-Babbas2", "title": "10.192.178.145 | unknown | MikroTik"}, {"id": "dev_7158245f", "label": "SXT-Babbas1", "title": "10.192.178.144 | unknown | MikroTik"}, {"id": "dev_06ec2916", "label": "Sw5-Dry-akhar.OKCO.ir", "title": "10.192.178.5 | unknown | cisco WS-C2960S-48FPS-L"}, {"id": "dev_3a0f97c1", "label": "SW6-Cold-Akhar.OKCO.ir", "title": "10.192.178.6 | unknown | cisco WS-C2960S-48FPS-L"}];
    const edges = [{"from": "dev_878920a8", "to": "dev_49f0dab0", "label": "GigabitEthernet1/0/42", "protocol": "CDP"}, {"from": "dev_878920a8", "to": "dev_762b3bad", "label": "GigabitEthernet1/0/40", "protocol": "CDP"}, {"from": "dev_878920a8", "to": "dev_552a5da9", "label": "GigabitEthernet1/0/47", "protocol": "CDP"}, {"from": "dev_878920a8", "to": "dev_0608a1e0", "label": "GigabitEthernet1/0/39", "protocol": "CDP"}, {"from": "dev_762b3bad", "to": "dev_1b421904", "label": "GigabitEthernet1/0/46", "protocol": "CDP"}, {"from": "dev_762b3bad", "to": "dev_7158245f", "label": "GigabitEthernet1/0/46", "protocol": "CDP"}, {"from": "dev_0608a1e0", "to": "dev_06ec2916", "label": "GigabitEthernet1/0/47", "protocol": "CDP"}, {"from": "dev_06ec2916", "to": "dev_3a0f97c1", "label": "GigabitEthernet1/0/47", "protocol": "CDP"}];
    const positions = {"dev_878920a8": {"x": 648.0, "y": 360.0}, "dev_49f0dab0": {"x": 580.6207996182657, "y": 545.1228315897233}, "dev_762b3bad": {"x": 410.010675168076, "y": 643.6246328675159}, "dev_552a5da9": {"x": 216.00000000000006, "y": 609.4153162899183}, "dev_0608a1e0": {"x": 89.36852521365842, "y": 458.50180127779265}, "dev_1b421904": {"x": 89.36852521365836, "y": 261.49819872220746}, "dev_7158245f": {"x": 215.9999999999999, "y": 110.58468371008172}, "dev_06ec2916": {"x": 410.01067516807586, "y": 76.37536713248403}, "dev_3a0f97c1": {"x": 580.6207996182657, "y": 174.8771684102766}};

    const svg = document.getElementById('svg');
    const tooltip = document.getElementById('tooltip');

    function resize() {
      const rect = svg.getBoundingClientRect();
      svg.setAttribute('viewBox', `0 0 ${rect.width} ${rect.height}`);
      draw(rect.width, rect.height);
    }

    function draw(width, height) {
      svg.innerHTML = '';
      const scaleX = width / (2 * 360);
      const scaleY = height / (2 * 360);

      const nodePos = Object.fromEntries(Object.entries(positions).map(([id, p]) => [
        id,
        { x: p.x * scaleX, y: p.y * scaleY }
      ]));

      // Draw edges
      edges.forEach(e => {
        const a = nodePos[e.from];
        const b = nodePos[e.to];
        if (!a || !b) return;
        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('x1', a.x);
        line.setAttribute('y1', a.y);
        line.setAttribute('x2', b.x);
        line.setAttribute('y2', b.y);
        line.setAttribute('class', 'edge');
        svg.appendChild(line);

        if (e.label || e.protocol) {
          const midX = (a.x + b.x) / 2;
          const midY = (a.y + b.y) / 2;
          const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          text.setAttribute('x', midX);
          text.setAttribute('y', midY - 4);
          text.setAttribute('class', 'edge-label');
          text.textContent = (e.protocol ? e.protocol + ' ' : '') + (e.label || '');
          svg.appendChild(text);
        }
      });

      // Draw nodes
      nodes.forEach(n => {
        const p = nodePos[n.id];
        if (!p) return;

        const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        g.setAttribute('cursor', 'pointer');
        g.addEventListener('mousemove', (evt) => {
          tooltip.style.display = 'block';
          tooltip.style.left = `${evt.clientX + 10}px`;
          tooltip.style.top = `${evt.clientY + 10}px`;
          tooltip.innerHTML = `<b>${n.label}</b><br/>${n.title || 'No details'}`;
        });
        g.addEventListener('mouseleave', () => {
          tooltip.style.display = 'none';
        });

        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        circle.setAttribute('cx', p.x);
        circle.setAttribute('cy', p.y);
        circle.setAttribute('r', 14);
        circle.setAttribute('class', 'node-circle');
        g.appendChild(circle);

        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        text.setAttribute('x', p.x);
        text.setAttribute('y', p.y + 26);
        text.setAttribute('class', 'node-label');
        text.setAttribute('text-anchor', 'middle');
        text.textContent = n.label;
        g.appendChild(text);

        svg.appendChild(g);
      });
    }

    window.addEventListener('resize', resize);
    resize();
  </script>
</body>
</html>

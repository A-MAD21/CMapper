<!DOCTYPE html>
<html>
<head>
    <title>Visual Network Map - roodan</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body { margin: 0; font-family: Arial, sans-serif; }
        .node { stroke: #fff; stroke-width: 1.5px; }
        .link { stroke: #999; stroke-opacity: 0.6; }
        .node-text { font-size: 12px; text-anchor: middle; }
        .info-panel { position: absolute; top: 10px; right: 10px; background: white; padding: 10px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <div class="info-panel">
        <h3>roodan Network</h3>
        <p>Devices: 7</p>
        <p>Connections: 9</p>
        <p>Generated: 2025-12-23 09:14:36</p>
    </div>

    <svg width="100%" height="100%"></svg>

    <script>
        // Network data
        const nodes = [{"id": "dev_ccef7ad6", "name": "Device-10.192.178.2", "ip": "10.192.178.2", "type": "unknown", "status": "online"}, {"id": "dev_fc485f4d", "name": "RW-Bandar.OKCO.ir", "ip": "10.192.178.1", "type": "unknown", "status": "online"}, {"id": "dev_53d86256", "name": "Sw4-Dry-BalayeEdari.OKCO.ir", "ip": "10.192.178.4", "type": "unknown", "status": "online"}, {"id": "dev_8582fbcc", "name": "BAbbad-DHCP", "ip": "10.192.178.253", "type": "unknown", "status": "online"}, {"id": "dev_42f1fd58", "name": "sw3-Dry-Buffer.OKCO.ir", "ip": "10.192.178.3", "type": "unknown", "status": "online"}, {"id": "dev_fbf8a625", "name": "Sw5-Dry-akhar.OKCO.ir", "ip": "10.192.178.5", "type": "unknown", "status": "online"}, {"id": "dev_368bc27c", "name": "SW6-Cold-Akhar.OKCO.ir", "ip": "10.192.178.6", "type": "unknown", "status": "online"}];

        const links = [{"source": "dev_ccef7ad6", "target": "dev_fc485f4d", "port": "GigabitEthernet1/0/42"}, {"source": "dev_ccef7ad6", "target": "dev_53d86256", "port": "GigabitEthernet1/0/40"}, {"source": "dev_ccef7ad6", "target": "dev_8582fbcc", "port": "GigabitEthernet1/0/47"}, {"source": "dev_ccef7ad6", "target": "dev_42f1fd58", "port": "GigabitEthernet1/0/39"}, {"source": "dev_42f1fd58", "target": "dev_ccef7ad6", "port": "GigabitEthernet1/0/48"}, {"source": "dev_42f1fd58", "target": "dev_fbf8a625", "port": "GigabitEthernet1/0/47"}, {"source": "dev_fbf8a625", "target": "dev_42f1fd58", "port": "GigabitEthernet1/0/48"}, {"source": "dev_fbf8a625", "target": "dev_368bc27c", "port": "GigabitEthernet1/0/47"}, {"source": "dev_368bc27c", "target": "dev_fbf8a625", "port": "GigabitEthernet2/0/48"}];

        // Create SVG
        const svg = d3.select("svg");
        const width = window.innerWidth;
        const height = window.innerHeight;

        svg.attr("width", width).attr("height", height);

        // Create simulation
        const simulation = d3.forceSimulation(nodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(100))
            .force("charge", d3.forceManyBody().strength(-300))
            .force("center", d3.forceCenter(width / 2, height / 2));

        // Create links
        const link = svg.append("g")
            .attr("class", "links")
            .selectAll("line")
            .data(links)
            .enter().append("line")
            .attr("class", "link");

        // Create nodes
        const node = svg.append("g")
            .attr("class", "nodes")
            .selectAll("circle")
            .data(nodes)
            .enter().append("circle")
            .attr("class", "node")
            .attr("r", d => d.type === 'switch' ? 12 : 8)
            .attr("fill", d => d.status === 'online' ? '#4CAF50' : '#f44336')
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        // Add labels
        const text = svg.append("g")
            .attr("class", "labels")
            .selectAll("text")
            .data(nodes)
            .enter().append("text")
            .attr("class", "node-text")
            .attr("dy", -15)
            .text(d => d.name.split('-')[0]); // Shorten names

        // Update positions
        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);

            text
                .attr("x", d => d.x)
                .attr("y", d => d.y);
        });

        // Drag functions
        function dragstarted(event, d) {
            if (!event.active) simulation.alphaTarget(0.3).restart();
            d.fx = d.x;
            d.fy = d.y;
        }

        function dragged(event, d) {
            d.fx = event.x;
            d.fy = event.y;
        }

        function dragended(event, d) {
            if (!event.active) simulation.alphaTarget(0);
            d.fx = null;
            d.fy = null;
        }

        // Handle window resize
        window.addEventListener('resize', () => {
            const newWidth = window.innerWidth;
            const newHeight = window.innerHeight;
            svg.attr("width", newWidth).attr("height", newHeight);
            simulation.force("center", d3.forceCenter(newWidth / 2, newHeight / 2));
            simulation.restart();
        });
    </script>
</body>
</html>